<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ğŸ³ä»é›¶å¼€å§‹DockeråŒ–Node.jsåº”ç”¨ | FEMessage blog</title>
    <meta name="description" content="things every member should konw">
    <link rel="icon" href="https://avatars3.githubusercontent.com/u/39977793?s=200&amp;v=4">
    
    <link rel="preload" href="/blog/assets/css/0.styles.7a18dcc6.css" as="style"><link rel="preload" href="/blog/assets/js/app.3b8fd8ff.js" as="script"><link rel="preload" href="/blog/assets/js/2.acf68d8b.js" as="script"><link rel="preload" href="/blog/assets/js/28.35749832.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.5ad27908.js"><link rel="prefetch" href="/blog/assets/js/11.3ab112bc.js"><link rel="prefetch" href="/blog/assets/js/12.f9248c70.js"><link rel="prefetch" href="/blog/assets/js/13.2d569f81.js"><link rel="prefetch" href="/blog/assets/js/14.04c2b1b3.js"><link rel="prefetch" href="/blog/assets/js/15.ca9221f8.js"><link rel="prefetch" href="/blog/assets/js/16.b0543377.js"><link rel="prefetch" href="/blog/assets/js/17.e1ee037e.js"><link rel="prefetch" href="/blog/assets/js/18.96fd91a0.js"><link rel="prefetch" href="/blog/assets/js/19.12894fc8.js"><link rel="prefetch" href="/blog/assets/js/20.2b016a9c.js"><link rel="prefetch" href="/blog/assets/js/21.1266966d.js"><link rel="prefetch" href="/blog/assets/js/22.65aedd87.js"><link rel="prefetch" href="/blog/assets/js/23.13b1a955.js"><link rel="prefetch" href="/blog/assets/js/24.935a9f39.js"><link rel="prefetch" href="/blog/assets/js/25.3ba8864c.js"><link rel="prefetch" href="/blog/assets/js/26.962211d0.js"><link rel="prefetch" href="/blog/assets/js/27.3b39b8d2.js"><link rel="prefetch" href="/blog/assets/js/29.c21efca1.js"><link rel="prefetch" href="/blog/assets/js/3.3faf71fd.js"><link rel="prefetch" href="/blog/assets/js/30.0457aba8.js"><link rel="prefetch" href="/blog/assets/js/31.66d8bfbb.js"><link rel="prefetch" href="/blog/assets/js/32.d9e6cf38.js"><link rel="prefetch" href="/blog/assets/js/33.bb99edf2.js"><link rel="prefetch" href="/blog/assets/js/34.34b16699.js"><link rel="prefetch" href="/blog/assets/js/35.d6a123cd.js"><link rel="prefetch" href="/blog/assets/js/36.414b1b84.js"><link rel="prefetch" href="/blog/assets/js/37.4acac353.js"><link rel="prefetch" href="/blog/assets/js/38.4056b126.js"><link rel="prefetch" href="/blog/assets/js/39.a6376cc7.js"><link rel="prefetch" href="/blog/assets/js/4.78dc510e.js"><link rel="prefetch" href="/blog/assets/js/5.3e614226.js"><link rel="prefetch" href="/blog/assets/js/6.4547ba14.js"><link rel="prefetch" href="/blog/assets/js/7.23588dac.js"><link rel="prefetch" href="/blog/assets/js/8.cb6fc9e8.js"><link rel="prefetch" href="/blog/assets/js/9.2dfce0f7.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.7a18dcc6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">FEMessage blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/FEMessage/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/FEMessage/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ç¼–ç </span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/docs/coding/basic-knowledge.html" class="sidebar-link">å‰ç«¯åŸºç¡€</a></li><li><a href="/blog/docs/coding/before-coding.html" class="sidebar-link">ç¼–ç¨‹ä¿®å…»</a></li><li><a href="/blog/docs/coding/clean-code-tips.html" class="sidebar-link">ç¼–ç æŠ€å·§</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ç¼–ç¨‹æ•…äº‹</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/docs/coding-story/achieve-commitment-and-deliver-available-software.html" class="sidebar-link">å±¥è¡Œæ‰¿è¯ºï¼Œäº¤ä»˜å¯ç”¨çš„åŠŸèƒ½</a></li><li><a href="/blog/docs/coding-story/how-can-we-fix-200-bugs-in-a-week.html" class="sidebar-link">ä¸€å‘¨æ¶ˆç­200ä¸ªbug</a></li><li><a href="/blog/docs/coding-story/practice-collective-ownership.html" class="sidebar-link">ç¼–ç¨‹æ¥åŠ›</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ç»„ä»¶ç ”å‘</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/docs/component-development/how-to-develop-open-source-vue-component-part-1-the-workflow.html" class="sidebar-link">ç»„ä»¶ç ”å‘æŒ‡å—ï¼ˆä¸€ï¼‰ï¼šç ”å‘æµç¨‹</a></li><li><a href="/blog/docs/component-development/how-to-develop-open-source-vue-component-part-2-hosting-in-private-registry.html" class="sidebar-link">ç»„ä»¶ç ”å‘æŒ‡å—ï¼ˆäºŒï¼‰ï¼šç§æœæ‰˜ç®¡</a></li><li><a href="/blog/docs/component-development/how-to-develop-open-source-vue-component-part-3-the-open-source-guide.html" class="sidebar-link">ç»„ä»¶ç ”å‘æŒ‡å—ï¼ˆä¸‰ï¼‰ï¼šå¼€æºåä½œ</a></li><li><a href="/blog/docs/component-development/how-to-develop-open-source-vue-component-part-4-thinking-improvement.html" class="sidebar-link">ç»„ä»¶ç ”å‘æŒ‡å—ï¼ˆå››ï¼‰ï¼šæ€ç»´æå‡</a></li><li><a href="/blog/docs/component-development/how-to-develop-open-source-vue-component-part-5-some-tips-may-help.html" class="sidebar-link">ç»„ä»¶ç ”å‘æŒ‡å—ï¼ˆäº”ï¼‰ï¼šåŸºç¡€æ‹¾é—</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>GITæŒ‡å—</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/docs/git/git-best-pratices.html" class="sidebar-link">GITæœ€ä½³å®è·µ</a></li><li><a href="/blog/docs/git/git-common-commands.html" class="sidebar-link">GITå¸¸ç”¨å‘½ä»¤</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>è½¯æŠ€èƒ½</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/docs/soft-skill/rules-of-thumb-and-nuggets-of-wisdom.html" class="sidebar-link">ç»éªŒæ³•åˆ™ä¸è‡³ç†åè¨€</a></li><li><a href="/blog/docs/soft-skill/search-tips.html" class="sidebar-link">æœç´¢æŠ€å·§</a></li><li><a href="/blog/docs/soft-skill/the-pyramid-priceple-using-in-github-pr.html" class="sidebar-link">é‡‘å­—å¡”åŸç†åœ¨Github PRä¸­çš„è¿ç”¨</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>æ•™ç¨‹</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/docs/tutorial/a-guide-for-chinese-frontend-developer-dockerizing-your-nodejs-app.html" class="active sidebar-link">ğŸ³ä»é›¶å¼€å§‹DockeråŒ–Node.jsåº”ç”¨</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/docs/tutorial/a-guide-for-chinese-frontend-developer-dockerizing-your-nodejs-app.html#èƒŒæ™¯" class="sidebar-link">èƒŒæ™¯</a></li><li class="sidebar-sub-header"><a href="/blog/docs/tutorial/a-guide-for-chinese-frontend-developer-dockerizing-your-nodejs-app.html#æ–¹æ¡ˆ" class="sidebar-link">æ–¹æ¡ˆ</a></li><li class="sidebar-sub-header"><a href="/blog/docs/tutorial/a-guide-for-chinese-frontend-developer-dockerizing-your-nodejs-app.html#faq" class="sidebar-link">FAQ</a></li><li class="sidebar-sub-header"><a href="/blog/docs/tutorial/a-guide-for-chinese-frontend-developer-dockerizing-your-nodejs-app.html#å‚è€ƒ" class="sidebar-link">å‚è€ƒ</a></li><li class="sidebar-sub-header"><a href="/blog/docs/tutorial/a-guide-for-chinese-frontend-developer-dockerizing-your-nodejs-app.html#æ³¨" class="sidebar-link">æ³¨</a></li></ul></li><li><a href="/blog/docs/tutorial/best-pratices-to-publish-vue-component-via-npm.html" class="sidebar-link">ğŸ“¦vueç»„ä»¶å‘å¸ƒnpmæœ€ä½³å®è·µ</a></li><li><a href="/blog/docs/tutorial/capture-and-rewrite-https-request.html" class="sidebar-link">ğŸ•¸æ•è·ä¸æ”¹å†™HTTPSè¯·æ±‚</a></li><li><a href="/blog/docs/tutorial/decode-base64-in-utf8.html" class="sidebar-link">è§£ç base64çš„utf-8å­—ç¬¦ä¸²</a></li><li><a href="/blog/docs/tutorial/how-to-write-a-github-app.html" class="sidebar-link">ğŸ¤–å¦‚ä½•å†™ä¸€ä¸ªGithub App</a></li><li><a href="/blog/docs/tutorial/integrate-github-with-netlify-to-preview-changes.html" class="sidebar-link">âš¡ï¸Githubé›†æˆNetlifyï¼šå¿«é€Ÿé¢„è§ˆPR</a></li><li><a href="/blog/docs/tutorial/integrate-github-with-travis-ci-to-auto-deployment.html" class="sidebar-link">ğŸš€Githubé›†æˆTravis CIï¼šè‡ªåŠ¨å‘å¸ƒ</a></li><li><a href="/blog/docs/tutorial/reveal-the-secret-of-a-powerful-tool-to-develop-vue-single-file-compoent.html" class="sidebar-link">ğŸ”¨æ­ç§˜vue-sfc-cliï¼šç»„ä»¶ç ”å‘åˆ©å™¨</a></li><li><a href="/blog/docs/tutorial/setup-an-automated-github-workflow.html" class="sidebar-link">ğŸŒªè‡ªåŠ¨åŒ–çš„Github Workflow</a></li><li><a href="/blog/docs/tutorial/test-driven-development-by-jest.html" class="sidebar-link">âœ…ä½¿ç”¨jestè¿›è¡Œæµ‹è¯•é©±åŠ¨å¼€å‘</a></li><li><a href="/blog/docs/tutorial/use-free-https-service.html" class="sidebar-link">ğŸ”’å…è´¹å¼€å¯HTTPS</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="content default"><h1 id="ğŸ³ä»é›¶å¼€å§‹dockeråŒ–node-jsåº”ç”¨"><a href="#ğŸ³ä»é›¶å¼€å§‹dockeråŒ–node-jsåº”ç”¨" aria-hidden="true" class="header-anchor">#</a> ğŸ³ä»é›¶å¼€å§‹DockeråŒ–Node.jsåº”ç”¨</h1> <h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" aria-hidden="true" class="header-anchor">#</a> èƒŒæ™¯</h2> <p>ç»™ä½ ä¸€å°æ–°ä¹°çš„æœåŠ¡å™¨(CentOS)ï¼Œç›¸å…³è´¦æˆ·åŠå¯†ç ï¼Œä¸€ä¸ªåŸºäºNode.jså¼€å‘çš„webåº”ç”¨æºç åŒ…(zip)ï¼Œè¦æ±‚ä½ åœ¨æ–°æœºå™¨ä¸Šä½¿ç”¨Dockerçš„æ–¹å¼æŠŠåº”ç”¨éƒ¨ç½²èµ·æ¥ã€‚æ­¤æ—¶çš„ä½ ï¼Œå¹¶æ²¡æœ‰ææ¸…æ¥šä»€ä¹ˆæ˜¯å®¹å™¨/é•œåƒï¼Œä¹Ÿæ²¡è®°ä½å‡ ä¸ªç›¸å…³çš„Linuxå‘½ä»¤ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿæœ¬æ–‡å°†å¸®åŠ©ä½ æ‘†è„±å›°å¢ƒ</p> <h2 id="æ–¹æ¡ˆ"><a href="#æ–¹æ¡ˆ" aria-hidden="true" class="header-anchor">#</a> æ–¹æ¡ˆ</h2> <h3 id="æµç¨‹"><a href="#æµç¨‹" aria-hidden="true" class="header-anchor">#</a> æµç¨‹</h3> <p>ä¸ºè¾¾åˆ°æœ€ç»ˆç›®çš„ï¼Œå…ˆæ¥æ¢³ç†ä¸€æ³¢æµç¨‹ï¼š</p> <ol><li>æŠŠæºç zipåŒ…ä¸Šä¼ è‡³æœåŠ¡å™¨</li> <li>ç™»å½•æœåŠ¡å™¨</li> <li>è§£å‹zipåŒ…</li> <li>å®‰è£…æœ€æ–°Docker</li> <li>è®¾ç½®å›½å†…é•œåƒåŠ é€Ÿå™¨</li> <li>ç¼–å†™Dockerfile</li> <li>æ„å»ºé•œåƒ</li> <li>ç¼–å†™å¯åŠ¨å®¹å™¨è„šæœ¬</li> <li>æ‰§è¡Œè„šæœ¬ï¼Œæ£€æŸ¥éƒ¨ç½²æƒ…å†µ</li></ol> <p>ä¸‹é¢å°†è¯¦ç»†æè¿°å¦‚ä½•æ“ä½œ</p> <blockquote><p>æ–‡ä¸­æœåŠ¡å™¨æ“ä½œç³»ç»Ÿä¸ºCentOS 7ï¼Œå¦‚æœä½ çš„æœåŠ¡å™¨ä¸ç›¸ç¬¦ï¼Œæ“ä½œç»†èŠ‚å¯èƒ½ä¼šç•¥æœ‰ä¸åŒï¼Œéœ€è¦å¦è¡ŒæŸ¥é˜…ç›¸å…³èµ„æ–™</p></blockquote> <h3 id="rsyncä¼ è¾“"><a href="#rsyncä¼ è¾“" aria-hidden="true" class="header-anchor">#</a> rsyncä¼ è¾“</h3> <p>å‡è®¾:</p> <ul><li>æœåŠ¡å™¨åœ°å€ä¸º<code>${ip}</code></li> <li>å¸æˆ·ä¸º<code>${user}</code></li> <li>å¯†ç ä¸º<code>${pass}</code></li> <li>æºç åŒ…ä¸º<code>${zip}</code></li> <li>zipåŒ…æ”¾åˆ°æœåŠ¡å™¨çš„ç›®å½•ä¸º<code>${path}</code></li></ul> <p>åˆ™åœ¨æœ¬æœºæºç åŒ…åŒçº§ç›®å½•ä¸‹ï¼Œä½¿ç”¨<code>scp</code>å‘½ä»¤ï¼ŒæŠŠzipåŒ…ä¼ è¾“è‡³æœåŠ¡å™¨çš„ç¤ºä¾‹å¦‚ä¸‹</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">rsync</span> -avzP ./<span class="token variable">${zip}</span> <span class="token variable">${user}</span>@<span class="token variable">${ip}</span><span class="token keyword">:</span><span class="token variable">${path}</span>

<span class="token comment"># åé¢ä¼šæç¤ºè¾“å…¥å¯†ç </span>
</code></pre></div><h3 id="sshç™»å½•"><a href="#sshç™»å½•" aria-hidden="true" class="header-anchor">#</a> sshç™»å½•</h3> <p>æ‰¿æ¥ä¸Šæ–‡ï¼Œsshç™»å½•æœåŠ¡å™¨ç¤ºä¾‹å¦‚ä¸‹</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">ssh</span> <span class="token variable">${user}</span>@<span class="token variable">${ip}</span>

<span class="token comment"># åé¢ä¼šæç¤ºè¾“å…¥å¯†ç </span>
<span class="token comment"># ç¬¬ä¸€æ¬¡ç™»å½•ä¼šæç¤ºä¿å­˜sshä¿¡æ¯ï¼Œè¾“å…¥yeså³å¯</span>
</code></pre></div><p>å¦‚æœä¸æƒ³æ¯æ¬¡éƒ½è¾“å…¥åœ°å€/å¸æˆ·/å¯†ç ï¼Œå¯ä»¥å†™ä¸€ä¸ªç®€å•çš„è‡ªåŠ¨ç™»å½•è„šæœ¬<code>ssh.sh</code></p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># åˆ›å»ºæ–‡ä»¶</span>
<span class="token function">touch</span> ssh.sh
<span class="token comment"># èµ‹äºˆè„šæœ¬å¯æ‰§è¡ŒæƒåŠ›</span>
<span class="token function">chmod</span> +x ssh.sh
</code></pre></div><p><code>ssh.sh</code>å†…å®¹å¦‚ä¸‹ï¼Œè®°å¾—æŠŠ<code>${pass}</code>, <code>${user}</code>,<code>${ip}</code>æ›¿æ¢ä¸ºçœŸå®æ•°æ®</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment">#!/usr/bin/expect</span>
<span class="token keyword">set</span> <span class="token function">timeout</span> 30
<span class="token keyword">set</span> password <span class="token variable">${pass}</span>
spawn <span class="token function">ssh</span> <span class="token variable">${user}</span>@<span class="token variable">${ip}</span>
<span class="token function">expect</span> <span class="token string">&quot;*assword:&quot;</span>
send <span class="token string">&quot;<span class="token variable">$password</span>\r&quot;</span>
interact
</code></pre></div><p>æ‰§è¡Œè„šæœ¬å³å¯ç™»å½•æœåŠ¡å™¨ğŸ˜„</p> <div class="language-sh extra-class"><pre class="language-sh"><code>./ssh.sh
</code></pre></div><h3 id="unzipè§£å‹"><a href="#unzipè§£å‹" aria-hidden="true" class="header-anchor">#</a> unzipè§£å‹</h3> <p>å¦‚ä¸Šæ‰€è¯´ï¼Œæºç åŒ…åä¸º<code>${zip}</code>ï¼Œè§£å‹å‘½ä»¤å¦‚ä¸‹</p> <div class="language-sh extra-class"><pre class="language-sh"><code>unzip <span class="token variable">${zip}</span>
</code></pre></div><p>é™„å¸¦ä¸€å¥, å¦‚æœè¦ç”¨å‘½ä»¤ç”ŸæˆzipåŒ…ï¼Œå‡è®¾æºæ–‡ä»¶ç›®å½•ä¸º<code>dist</code>ï¼Œè¦ç”Ÿæˆçš„zipåŒ…ä¸º<code>dist.zip</code>, å…¶å‘½ä»¤å¦‚ä¸‹</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">zip</span> -r dist.zip dist
<span class="token comment"># æˆ–ç®€å†™ä¸º</span>
<span class="token function">zip</span> -r dist dist
</code></pre></div><h3 id="å®‰è£…docker-ce"><a href="#å®‰è£…docker-ce" aria-hidden="true" class="header-anchor">#</a> å®‰è£…Docker-CE</h3> <p>CEæ„ä¸º<code>Community Edition</code>, å³ç¤¾åŒºç‰ˆï¼Œå…è´¹; ä¸ä¹‹å¯¹åº”çš„æ˜¯EEï¼Œ<code>Enterprise Edition</code>,  ä¼ä¸šç‰ˆï¼Œå¼ºè°ƒå®‰å…¨ï¼Œä»˜è´¹ä½¿ç”¨ã€‚</p> <ul><li>å¸è½½æ—§ç‰ˆæœ¬çš„Docker</li></ul> <p>å¦‚æœæ–°æœºå™¨ä¸Šæ²¡æœ‰dockerï¼Œè·³è‡³ä¸‹ä¸€æ­¥ï¼Œç›´æ¥å®‰è£…Dockerçš„ä¾èµ–</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> yum remove docker \
                  docker-common \
                  container-selinux \
                  docker-selinux \
                  docker-engine \
                  docker-engine-selinux
</code></pre></div><ul><li>å®‰è£…Dockerçš„ä¾èµ–</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> yum <span class="token function">install</span> -y yum-utils device-mapper-persistent-data lvm2
</code></pre></div><ul><li>å®‰è£…Dockerå®˜æ–¹ä»“åº“</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> yum-config-manager \
    --add-repo \
    https://download.docker.com/linux/centos/docker-ce.repo
</code></pre></div><ul><li>æ›´æ–°ä»“åº“æº</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> yum makecache fast
</code></pre></div><ul><li>ä»ä»“åº“å®‰è£…Docker-CE</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> yum <span class="token function">install</span> docker-ce
</code></pre></div><h3 id="é…ç½®åŠ é€Ÿå™¨"><a href="#é…ç½®åŠ é€Ÿå™¨" aria-hidden="true" class="header-anchor">#</a> é…ç½®åŠ é€Ÿå™¨</h3> <p>ä½¿ç”¨ Docker çš„æ—¶å€™ï¼Œéœ€è¦ç»å¸¸ä»å®˜æ–¹è·å–é•œåƒï¼Œä½†æ˜¯ç”±äºæ˜¾è€Œæ˜“è§çš„ç½‘ç»œåŸå› ï¼Œæ‹‰å–é•œåƒçš„è¿‡ç¨‹éå¸¸è€—æ—¶ï¼Œä¸¥é‡å½±å“ä½¿ç”¨ Docker çš„ä½“éªŒã€‚</p> <p>æ¨èä½¿ç”¨<a href="https://www.daocloud.io/mirror#accelerator-doc" target="_blank" rel="noopener noreferrer">DaoCloudçš„åŠ é€Ÿå™¨<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="dockerfile"><a href="#dockerfile" aria-hidden="true" class="header-anchor">#</a> Dockerfile</h3> <p>æ‰€æœ‰ç¯å¢ƒé…ç½®å·²å‡†å¤‡å®Œæ¯•ï¼Œå¯ä»¥æ ¹æ®Node.jsåº”ç”¨ç¼–å†™Dockerfileäº†</p> <p>å‡è®¾Node.jsåº”ç”¨çš„å¯åŠ¨å‘½ä»¤ä¸º<code>npm start</code>, ç›‘å¬ç«¯å£ä¸º<code>${app_port}</code></p> <ul><li>åˆ›å»ºDockerfile</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">touch</span> Dockerfile
</code></pre></div><p><code>Dockerfile</code>å†…å®¹å¦‚ä¸‹</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># å¯ä»¥æŒ‡å®šä¾èµ–çš„nodeé•œåƒçš„ç‰ˆæœ¬ node:&lt;version&gt;ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œå°±ä¼šæ˜¯æœ€æ–°çš„</span>
FROM node:8

<span class="token comment"># åˆ›å»ºå·¥ä½œç›®å½•ï¼Œå¯¹åº”çš„æ˜¯åº”ç”¨ä»£ç å­˜æ”¾åœ¨å®¹å™¨å†…çš„è·¯å¾„</span>
WORKDIR /usr/src/app

<span class="token comment"># æŠŠ package.jsonï¼Œpackage-lock.json(npm@5+) æˆ– yarn.lock å¤åˆ¶åˆ°å·¥ä½œç›®å½•(ç›¸å¯¹è·¯å¾„)</span>
COPY package.json *.lock <span class="token keyword">.</span>

<span class="token comment"># åªå®‰è£…dependenciesä¾èµ–</span>
<span class="token comment"># nodeé•œåƒè‡ªå¸¦yarn</span>
RUN yarn --only<span class="token operator">=</span>prod --registry<span class="token operator">=</span>https://registry.npm.taobao.org

<span class="token comment"># æŠŠå…¶ä»–æºæ–‡ä»¶å¤åˆ¶åˆ°å·¥ä½œç›®å½•</span>
COPY <span class="token keyword">.</span> <span class="token keyword">.</span>

<span class="token comment"># æ›¿æ¢æˆåº”ç”¨å®é™…çš„ç«¯å£å·</span>
EXPOSE <span class="token variable">${app_port}</span>

<span class="token comment"># è¿™é‡Œæ ¹æ®å®é™…èµ·åŠ¨å‘½ä»¤åšä¿®æ”¹</span>
CMD <span class="token punctuation">[</span> <span class="token string">&quot;npm&quot;</span>, <span class="token string">&quot;start&quot;</span> <span class="token punctuation">]</span>
</code></pre></div><ul><li>è¡¥å…….dockerignore</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">touch</span> .dockerignore
</code></pre></div><p><code>.dockerignore</code>å†…å®¹å¦‚ä¸‹</p> <div class="language-sh extra-class"><pre class="language-sh"><code>node_modules
npm-debug.log
</code></pre></div><h3 id="æ„å»ºé•œåƒ"><a href="#æ„å»ºé•œåƒ" aria-hidden="true" class="header-anchor">#</a> æ„å»ºé•œåƒ</h3> <p>å†™å¥½<code>Dockerfile</code>ï¼Œå°±å¯ä»¥åœ¨Dockerfileæ‰€åœ¨ç›®å½•æ„å»ºé•œåƒäº†ã€‚</p> <p>å‘½ä»¤å¦‚ä¸‹ã€‚<code>-t</code>æ˜¯ä¸ºäº†ç»™é•œåƒåŠ ä¸ªæ ‡ç­¾ï¼Œè¿™æ ·æ–¹ä¾¿ä½¿ç”¨<code>docker images</code>å‘½ä»¤æ—¶æ£€ç´¢åˆ°</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># ${your_name} å¯ä»¥çœç•¥</span>
<span class="token comment"># ${tag} çœç•¥æ—¶ä¸º latest</span>
docker build -t <span class="token variable">${your_name}</span>/<span class="token variable">${image_name}</span><span class="token keyword">:</span><span class="token variable">${tag}</span> <span class="token keyword">.</span>

<span class="token comment"># çœç•¥ç‰ˆæœ¬</span>
docker build -t <span class="token variable">${image_name}</span> <span class="token keyword">.</span>
</code></pre></div><p>æŸ¥çœ‹é•œåƒ</p> <div class="language-sh extra-class"><pre class="language-sh"><code>docker images

<span class="token comment"># ç¤ºä¾‹è¾“å‡º</span>
REPOSITORY                      TAG        ID              CREATED
node                            8          1934b0b038d1    5 days ago
<span class="token variable">${your_name}</span>/<span class="token variable">${image_name}</span>    latest     d64d3505b0d2    1 minute ago
</code></pre></div><h3 id="å¯åŠ¨å®¹å™¨è„šæœ¬"><a href="#å¯åŠ¨å®¹å™¨è„šæœ¬" aria-hidden="true" class="header-anchor">#</a> å¯åŠ¨å®¹å™¨è„šæœ¬</h3> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">touch</span> start.sh
<span class="token function">chmod</span> +x start.sh
</code></pre></div><p><code>start.sh</code>ä¼šæ ¹æ®é•œåƒæ–°å»ºä¸€ä¸ªå®¹å™¨å¹¶å¯åŠ¨ï¼Œå†…å®¹å¦‚ä¸‹</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment">#!/usr/bin/env bash</span>

container<span class="token operator">=</span><span class="token variable">${container_name}</span>
image<span class="token operator">=</span><span class="token variable">${image_name || image_id}</span>

docker run \
--rm \
-d \
-p <span class="token variable">${host_port}</span><span class="token keyword">:</span><span class="token variable">${app_port}</span> \
--name <span class="token variable">$container</span> \
<span class="token variable">$image</span>
</code></pre></div><p><code>${host_port}</code>æ˜¯å¤–ç½‘è®¿é—®éƒ¨ç½²å¥½çš„åº”ç”¨æ—¶å¯¹åº”çš„ç«¯å£</p> <p><code>${app_port}</code>æ˜¯å®¹å™¨å†…Node.jsåº”ç”¨ç›‘å¬çš„ç«¯å£</p> <p><code>${image_name}</code>æ˜¯å‰é¢æ„å»ºå‡ºçš„é•œåƒçš„åå­—ï¼Œå¯ç”¨<code>docker images</code>æŸ¥çœ‹</p> <p><code>${container_name}</code>æ˜¯ç»™å®¹å™¨èµ‹äºˆçš„åå­—ï¼Œæ–¹ä¾¿<code>docker ps</code>å‘½ä»¤æ—¶æ£€ç´¢</p> <p>--rm å®¹å™¨é€€å‡ºåéšä¹‹å°†å…¶åˆ é™¤</p> <p>-d åå°è¿è¡Œ</p> <p>-p æŒ‡å®šç«¯å£æ˜ å°„ï¼Œå‰è€…æ˜¯æœåŠ¡å™¨å™¨ç«¯å£ï¼Œä¹Ÿå³å¤–ç•Œè®¿é—®ä½ éƒ¨ç½²å¥½çš„webåº”ç”¨çš„ç«¯å£; åè€…æ˜¯<code>Dockerfile</code>é‡Œ<code>EXPOSE</code>çš„ç«¯å£</p> <p>--name æŒ‡å®šå®¹å™¨åå­—</p> <h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" aria-hidden="true" class="header-anchor">#</a> æµ‹è¯•</h3> <p>è®¿é—®åˆšåˆšå¯åŠ¨çš„å®¹å™¨é‡Œçš„åº”ç”¨</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">curl</span> -i localhost:<span class="token variable">${host_port}</span>

<span class="token comment"># ç¤ºä¾‹è¾“å‡º</span>
HTTP/1.1 200 OK
X-Powered-By: Express
Content-Type: text/html<span class="token punctuation">;</span> charset<span class="token operator">=</span>utf-8
<span class="token punctuation">..</span>.
</code></pre></div><p>æ­å–œï¼Œéƒ¨ç½²æˆåŠŸğŸ‘</p> <h3 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" aria-hidden="true" class="header-anchor">#</a> å¸¸ç”¨å‘½ä»¤</h3> <ul><li>æŸ¥çœ‹è¿è¡Œä¸­çš„å®¹å™¨</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>docker <span class="token function">ps</span>
<span class="token comment"># æˆ–ä½¿ç”¨æ–°å‘½ä»¤</span>
docker container <span class="token function">ls</span>

<span class="token comment"># ç¤ºä¾‹è¾“å‡º</span>
ID            IMAGE                                COMMAND    <span class="token punctuation">..</span>.   PORTS
ecce33b30ebf  <span class="token variable">${your_name}</span>/<span class="token variable">${image_name}</span>:latest  <span class="token function">npm</span> start  <span class="token punctuation">..</span>.   49160-<span class="token operator">&gt;</span>8080
</code></pre></div><ul><li>æŸ¥çœ‹æ‰€æœ‰å®¹å™¨(åŒ…æ‹¬å·²ç»ˆæ­¢çš„)</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>docker <span class="token function">ps</span> -a
<span class="token comment"># æˆ–ä½¿ç”¨æ–°å‘½ä»¤</span>
docker container <span class="token function">ls</span> -a
</code></pre></div><ul><li>æŸ¥çœ‹æŸå®¹å™¨å†…æ—¥å¿—</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>docker logs -f <span class="token variable">${container_id}</span>
</code></pre></div><ul><li>è¿›å…¥æŸå®¹å™¨ï¼Œå¹¶æœ‰shellæ‰§è¡Œç¯å¢ƒ</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># è¿›å…¥å®¹å™¨</span>
<span class="token comment"># -iè¡¨ç¤ºï¼šäº¤äº’å¼æ“ä½œï¼Œ-tè¡¨ç¤ºï¼šç»ˆç«¯</span>
docker <span class="token function">exec</span> -it <span class="token variable">${container_id}</span> <span class="token function">bash</span>
<span class="token comment"># å¯é€šè¿‡è¾“å…¥ exit é€€å‡º</span>
</code></pre></div><ul><li>åœæ­¢å®¹å™¨</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>docker container stop <span class="token variable">${container_id}</span>
</code></pre></div><ul><li>å¯åŠ¨å·²ç»ˆæ­¢çš„å®¹å™¨</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>docker container start <span class="token variable">${container_id}</span>
</code></pre></div><ul><li>åˆ é™¤å®¹å™¨</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>docker container <span class="token function">rm</span> <span class="token variable">${container_name || container_id}</span>
</code></pre></div><ul><li>æŸ¥çœ‹é•œåƒ</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>docker images
<span class="token comment"># æˆ–ä½¿ç”¨æ–°å‘½ä»¤</span>
docker image <span class="token function">ls</span>
</code></pre></div><ul><li>åˆ é™¤é•œåƒ</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>docker image <span class="token function">rm</span> <span class="token variable">${image_id}</span>
</code></pre></div><h2 id="faq"><a href="#faq" aria-hidden="true" class="header-anchor">#</a> FAQ</h2> <ul><li>ä¸ä¼šviï¼Œä¸æ‡‚æ€ä¹ˆåœ¨æœåŠ¡å™¨ç¼–è¾‘<code>Dockerfile</code>ç­‰æ–‡ä»¶ï¼Œæ€ä¹ˆåŠï¼Ÿ</li></ul> <blockquote><p>å¯ä»¥å‚è€ƒæœ¬æ–‡ï¼ŒæŠŠæ–‡ä»¶åœ¨æœ¬åœ°åˆ›å»ºå¥½ï¼Œå†é€šè¿‡<code>scp</code>æŠŠåˆ›å»ºçš„æ–‡ä»¶è·Ÿæºç åŒ…ä¸€èµ·ä¸Šä¼ åˆ°æœåŠ¡å™¨</p></blockquote> <ul><li>ä¸ºä»€ä¹ˆä½¿ç”¨yarn?</li></ul> <blockquote><p>å› ä¸ºyarnçš„é€Ÿåº¦æ¯”npmæ›´å¿«ï¼Œè€Œdockeré‡Œçš„nodeé•œåƒè‡ªå¸¦äº†yarn, æ­£å¥½é¼“åŠ±å¤§å®¶ä½¿ç”¨yarn</p></blockquote> <ul><li>å¦‚æœé¡¹ç›®æœ‰å…¨å±€ä¾èµ–ï¼Œå¦‚bowerï¼ŒDockerfileæ€ä¹ˆå†™ï¼Ÿ</li></ul> <blockquote><p>å¯ä»¥å…ˆå®‰è£…å…¶ä»–å…¨å±€ä¾èµ–ï¼Œå†ä½¿ç”¨yarnå®‰è£…ï¼Œè®°å¾—å‘½ä»¤å†™åœ¨ä¸€ä¸ªRUNæŒ‡ä»¤é‡Œ, ä¸‹é¢æ˜¯éƒ¨åˆ†ç¤ºä¾‹</p></blockquote> <div class="language-sh extra-class"><pre class="language-sh"><code>RUN yarn config <span class="token keyword">set</span> registry https://registry.npm.taobao.org \
    <span class="token operator">&amp;&amp;</span> yarn global <span class="token function">install</span> bower \
    <span class="token operator">&amp;&amp;</span> bower i --allow-root \
    yarn
</code></pre></div><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" aria-hidden="true" class="header-anchor">#</a> å‚è€ƒ</h2> <ul><li><a href="https://nodejs.org/en/docs/guides/nodejs-docker-webapp" target="_blank" rel="noopener noreferrer">https://nodejs.org/en/docs/guides/nodejs-docker-webapp<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/nodejs/docker-node/blob/master/README.md#image-variants" target="_blank" rel="noopener noreferrer">https://github.com/nodejs/docker-node/blob/master/README.md#image-variants<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/waylybaye/HyperApp-Guide/blob/master/zh/centos-upgrade-docker.md" target="_blank" rel="noopener noreferrer">https://github.com/waylybaye/HyperApp-Guide/blob/master/zh/centos-upgrade-docker.md<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://docs.docker.com/v1.11/engine/reference/commandline/cli/" target="_blank" rel="noopener noreferrer">Dockerå‘½ä»¤æŸ¥è¯¢<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="æ³¨"><a href="#æ³¨" aria-hidden="true" class="header-anchor">#</a> æ³¨</h2> <p>æœ¬æ–‡æœ€æ—©å‘å¸ƒåœ¨æ˜é‡‘ï¼Œåè¿ç§»è‡³<a href="https://github.com/levy9527/blog/issues/3" target="_blank" rel="noopener noreferrer">github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/FEMessage/blog/edit/master/docs/tutorial/a-guide-for-chinese-frontend-developer-dockerizing-your-nodejs-app.md" target="_blank" rel="noopener noreferrer">å¸®åŠ©æˆ‘ä»¬å®Œå–„æ­¤é¡µé¢</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/blog/docs/soft-skill/the-pyramid-priceple-using-in-github-pr.html" class="prev">
          é‡‘å­—å¡”åŸç†åœ¨Github PRä¸­çš„è¿ç”¨
        </a></span> <span class="next"><a href="/blog/docs/tutorial/best-pratices-to-publish-vue-component-via-npm.html">
          ğŸ“¦vueç»„ä»¶å‘å¸ƒnpmæœ€ä½³å®è·µ
        </a>
        â†’
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.3b8fd8ff.js" defer></script><script src="/blog/assets/js/2.acf68d8b.js" defer></script><script src="/blog/assets/js/28.35749832.js" defer></script>
  </body>
</html>
