(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{219:function(t,s,a){"use strict";a.r(s);var e=a(2),n=Object(e.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"🔨揭秘vue-sfc-cli：组件研发利器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#🔨揭秘vue-sfc-cli：组件研发利器","aria-hidden":"true"}},[t._v("#")]),t._v(" 🔨揭秘vue-sfc-cli：组件研发利器")]),t._v(" "),a("h2",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言","aria-hidden":"true"}},[t._v("#")]),t._v(" 前言")]),t._v(" "),a("p",[t._v("本文将揭示vue单文件组件的工具 "),a("a",{attrs:{href:"https://github.com/FEMessage/vue-sfc-cli",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue-sfc-cli"),a("OutboundLink")],1),t._v(" 的内涵，说明它是如何在整个组件研发流程中提升效率的。")]),t._v(" "),a("p",[t._v("本文可以看成是 "),a("a",{attrs:{href:"https://github.com/levy9527/blog/issues/2",target:"_blank",rel:"noopener noreferrer"}},[t._v("📦vue组件发布npm最佳实践"),a("OutboundLink")],1),t._v(" 的成长篇，是 "),a("a",{attrs:{href:"https://github.com/levy9527/blog/issues/12",target:"_blank",rel:"noopener noreferrer"}},[t._v("🤖自动化的Github Workflow"),a("OutboundLink")],1),t._v(" 的姐妹篇，是团队最佳实践的落地产物，涉及的背景知识有点多，需要花点时间消化🤔")]),t._v(" "),a("h2",{attrs:{id:"使用教程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用教程","aria-hidden":"true"}},[t._v("#")]),t._v(" 使用教程")]),t._v(" "),a("h3",{attrs:{id:"快速开始"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#快速开始","aria-hidden":"true"}},[t._v("#")]),t._v(" 快速开始")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("npx vue-sfc-cli\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 接下来会有一串的提示，请务必填写")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 推荐kebab-case风格，小写字母，多个单词用-（dash）分隔，如my-component")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 填充完提示后")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cd")]),t._v(" my-component\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 使用git初始化，这样可以使用commit hook")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" init\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装依赖")]),t._v("\nyarn\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 开始开发")]),t._v("\nyarn dev\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 打包")]),t._v("\nyarn build\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 可以发布了！")]),t._v("\nyarn publish\n")])])]),a("h3",{attrs:{id:"参数选项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参数选项","aria-hidden":"true"}},[t._v("#")]),t._v(" 参数选项")]),t._v(" "),a("p",[a("code",[t._v("-u, --upgrade")]),t._v("\n根据 template目录下模板，生成新的文件，更新到当前组件中。使用的是覆盖策略，默认覆盖的文件定义在 update-files.js。常用于使用最新版本vue-sfc-cli对旧组件的配置进行升级")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd my-component")]),t._v("\nnpx vue-sfc-cli -u\n")])])]),a("p",[a("code",[t._v("--files")]),t._v("\n如果想更新额外的文件，可以传此选项，后接文件名，多个文件使用 "),a("code",[t._v(",")]),t._v(" 分隔")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("npx vue-sfc-cli -u --files package.json,.babelrc.js\n")])])]),a("p",[a("code",[t._v("--test")]),t._v("\n生成一个测试的组件模板，常用于ci环境测试。")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("npx vue-sfc-cli --test\n")])])]),a("h3",{attrs:{id:"示例文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例文档","aria-hidden":"true"}},[t._v("#")]),t._v(" 示例文档")]),t._v(" "),a("p",[t._v("在docs目录下，新建 "),a("code",[t._v("md")]),t._v(" 文件，建议命名同样是kebab-case")]),t._v(" "),a("p",[t._v("以上传组件"),a("a",{attrs:{href:"https://github.com/FEMessage/upload-to-ali",target:"_blank",rel:"noopener noreferrer"}},[t._v("upload-to-ali"),a("OutboundLink")],1),t._v("的 docs/draggable.md 文档为例 \n"),a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/006y8mN6gy1g6njnx6bzxj315q0ncmyy.jpg",alt:"image.png"}})]),t._v(" "),a("p",[a("code",[t._v("yarn dev")]),t._v(" 时会转这个markdown文件就会换成demo，可以看到实际代码，还可以实时修改代码，让demo刷新")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/006y8mN6gy1g6njzaqijoj31fe0ra0vh.jpg",alt:"image.png"}})]),t._v(" "),a("h3",{attrs:{id:"api文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#api文档","aria-hidden":"true"}},[t._v("#")]),t._v(" API文档")]),t._v(" "),a("p",[t._v("在vue文件里，编写注释，即可生成API文档。")]),t._v(" "),a("h4",{attrs:{id:"props"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#props","aria-hidden":"true"}},[t._v("#")]),t._v(" props")]),t._v(" "),a("p",[t._v("在props里使用多行注释\n"),a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/006y8mN6gy1g6njp9z99jj315w0comxo.jpg",alt:"image.png"}})]),t._v(" "),a("h4",{attrs:{id:"slot"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#slot","aria-hidden":"true"}},[t._v("#")]),t._v(" slot")]),t._v(" "),a("p",[t._v("在slot上一行，使用  @slot 开头的注释\n"),a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/006y8mN6gy1g6njpim5svj315u0b80u4.jpg",alt:"image.png"}})]),t._v(" "),a("h4",{attrs:{id:"event"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#event","aria-hidden":"true"}},[t._v("#")]),t._v(" event")]),t._v(" "),a("p",[t._v("在emit事件上方，使用多行注释\n"),a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/006y8mN6gy1g6njptoul6j315o07q74q.jpg",alt:"image.png"}})]),t._v(" "),a("h4",{attrs:{id:"methods"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#methods","aria-hidden":"true"}},[t._v("#")]),t._v(" methods")]),t._v(" "),a("p",[t._v("在要公开显示的方法上方，使用多行注释，并添加 @public\n"),a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/006y8mN6gy1g6njq2ydpaj315i0a2aak.jpg",alt:"image.png"}})]),t._v(" "),a("p",[t._v("效果预览\n"),a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/006y8mN6gy1g6njqezjjkj31q70u0k18.jpg",alt:"image.png"}}),t._v(" "),a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/006y8mN6gy1g6njqlyo25j31lt0u0tg0.jpg",alt:"image.png"}})]),t._v(" "),a("h3",{attrs:{id:"引入第三方库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#引入第三方库","aria-hidden":"true"}},[t._v("#")]),t._v(" 引入第三方库")]),t._v(" "),a("p",[t._v("以"),a("a",{attrs:{href:"https://element.eleme.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Element-UI"),a("OutboundLink")],1),t._v("为例")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("yarn add element-ui\n")])])]),a("p",[t._v("新增一个文件："),a("code",[t._v("styleguide/element.js")])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Vue "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vue'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Element "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'element-ui'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'element-ui/lib/theme-chalk/index.css'")]),t._v("\nVue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Element"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("修改配置文件："),a("code",[t._v("styleguide.config.js")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/006y8mN6gy1g6njqyuhg1j314k084q36.jpg",alt:"image.png"}})]),t._v(" "),a("h3",{attrs:{id:"环境变量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#环境变量","aria-hidden":"true"}},[t._v("#")]),t._v(" 环境变量")]),t._v(" "),a("p",[t._v("如果需要使用环境变量，推荐使用 "),a("code",[t._v("dotenv")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("yarn add dotenv --dev\n")])])]),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/006y8mN6gy1g6njrhmhsvj315q0i6dh4.jpg",alt:"image.png"}})]),t._v(" "),a("h3",{attrs:{id:"prettier-and-husky"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#prettier-and-husky","aria-hidden":"true"}},[t._v("#")]),t._v(" prettier and husky")]),t._v(" "),a("p",[t._v("组件模板内置prettier, 可以在提交代码时格式化。")]),t._v(" "),a("p",[t._v("注意的是需要先执行 "),a("code",[t._v("git init")]),t._v(" 命令，之后再执行 "),a("code",[t._v("yarn")]),t._v(" 安装依赖，否则提交钩子不生效。")]),t._v(" "),a("h3",{attrs:{id:"注意"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#注意","aria-hidden":"true"}},[t._v("#")]),t._v(" 注意")]),t._v(" "),a("p",[t._v("不建议在Windows下生成组件,因为.sh可能没有执行权限。")]),t._v(" "),a("h2",{attrs:{id:"技术详解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#技术详解","aria-hidden":"true"}},[t._v("#")]),t._v(" 技术详解")]),t._v(" "),a("h3",{attrs:{id:"技术概览"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#技术概览","aria-hidden":"true"}},[t._v("#")]),t._v(" 技术概览")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/vue-styleguidist/vue-styleguidist",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue-styleguidist"),a("OutboundLink")],1),t._v(" 本地开发demo与生成文档")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://jestjs.io/docs/en/getting-started",target:"_blank",rel:"noopener noreferrer"}},[t._v("jest"),a("OutboundLink")],1),t._v(" 单元测试")]),t._v(" "),a("li",[t._v("prettier + husky 代码格式化")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://rollupjs.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("rollup"),a("OutboundLink")],1),t._v(" 打包")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/conventional-changelog/standard-version",target:"_blank",rel:"noopener noreferrer"}},[t._v("standard-version"),a("OutboundLink")],1),t._v(" 自动生成changelog")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/github-tools/github-release-notes",target:"_blank",rel:"noopener noreferrer"}},[t._v("github-release-notes"),a("OutboundLink")],1),t._v(" 生成github release")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/levy9527/auto-add-label",target:"_blank",rel:"noopener noreferrer"}},[t._v("auto-add-label"),a("OutboundLink")],1),t._v(" 为pr自动添加label")]),t._v(" "),a("li",[t._v("netlify 预览pr")]),t._v(" "),a("li",[t._v("travis ci 发布npm/github pages")]),t._v(" "),a("li",[t._v("shell + dingtalk api 发布成功后发送钉钉消息")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/all-contributors/all-contributors",target:"_blank",rel:"noopener noreferrer"}},[t._v("all-contributors"),a("OutboundLink")],1),t._v(" 显示贡献者")]),t._v(" "),a("li",[t._v("内置README.md模板，包括目录结构、返回顶部以及一些常见的badge")])]),t._v(" "),a("h3",{attrs:{id:"模板目录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#模板目录","aria-hidden":"true"}},[t._v("#")]),t._v(" 模板目录")]),t._v(" "),a("p",[t._v("以下是生成的组件默认模板配置")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("├── .all-contributorsrc  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# all-contributors配置")]),t._v("\n├── .babelrc \n├── .editorconfig\n├── .gitignore\n├── .grenrc.js           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# github-release-notes配置")]),t._v("\n├── .prettierignore      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# prettier配置")]),t._v("\n├── .prettierrc          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# prettier配置")]),t._v("\n├── .travis.yml          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# travis ci配置")]),t._v("\n├── LICENSE              "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# MIT")]),t._v("\n├── README.md            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 自述文件")]),t._v("\n├── build                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# rollup配置")]),t._v("\n│   └── rollup.config.js\n├── build.sh             "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ci相关文件")]),t._v("\n├── dist                 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 打包输出目录")]),t._v("\n├── docs                 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 使用文档，这些md会转换成demo")]),t._v("\n│   ├── basic.md \n├── notify.sh            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ci相关文件，用于钉钉通知")]),t._v("\n├── package.json\n├── src                   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 源文件目录")]),t._v("\n│   ├── index.js\n│   └── upload-to-ali.vue "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 单文件组件")]),t._v("\n├── styleguide.config.js  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# vue-styleguidist配置文件")]),t._v("\n└── yarn.lock \n")])])]),a("h3",{attrs:{id:"开发"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开发","aria-hidden":"true"}},[t._v("#")]),t._v(" 开发")]),t._v(" "),a("p",[t._v("选用"),a("a",{attrs:{href:"https://github.com/vue-styleguidist/vue-styleguidist",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue-styleguidist"),a("OutboundLink")],1),t._v("的原因是，好处是：书写md，既可以充当文档，又可以转换成可运行的demo。")]),t._v(" "),a("p",[t._v("这样的好处是，文档与demo一体化，不用同时维护两份代码。")]),t._v(" "),a("p",[t._v("修改md、修改源文件，demo是会hot reload的，非常方便。")]),t._v(" "),a("h3",{attrs:{id:"测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#测试","aria-hidden":"true"}},[t._v("#")]),t._v(" 测试")]),t._v(" "),a("p",[t._v("对于组件的测试，大家首先想到的是相关的工具集"),a("a",{attrs:{href:"https://vue-test-utils.vuejs.org/guides/#getting-started",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue-test-utils"),a("OutboundLink")],1),t._v("，然后觉得，组件测试有点难写，或者说，不知道怎么写。")]),t._v(" "),a("p",[t._v("其实可以换个思路，先从简单的做起。做单元测试，更重要的是培养写测试的习惯，所以一开始建议只用jest对纯函数进行测试。")]),t._v(" "),a("p",[t._v("也即，把组件里的方法抽取出来，单独放到一个文件里，然后专门对这些函数进行测试。")]),t._v(" "),a("p",[t._v("这样的好处是，为了方便测试：")]),t._v(" "),a("ul",[a("li",[t._v("开发者在写组件时，需要尽可能地写短小精悍的函数")]),t._v(" "),a("li",[t._v("函数要写成纯函数，也即不依赖或影响到全局变量")])]),t._v(" "),a("p",[t._v("这样的方法，也很适合对一个完全没有测试的组件，逐步补充测试用例。")]),t._v(" "),a("p",[t._v("下面是 "),a("a",{attrs:{href:"https://github.com/FEMessage/el-data-table",target:"_blank",rel:"noopener noreferrer"}},[t._v("el-data-table"),a("OutboundLink")],1),t._v(" 对纯函数测试的代码示例")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/006y8mN6gy1g6njyb3t9gj31520cyt9u.jpg",alt:"image.png"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/006y8mN6gy1g6njy63k0uj31500ki40k.jpg",alt:"image.png"}})]),t._v(" "),a("p",[t._v("更多请看：✅使用jest进行测试驱动开发")]),t._v(" "),a("h3",{attrs:{id:"构建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#构建","aria-hidden":"true"}},[t._v("#")]),t._v(" 构建")]),t._v(" "),a("p",[a("code",[t._v("yarn build")]),t._v(" 即可构建生成三个文件：")]),t._v(" "),a("ul",[a("li",[t._v("upload-to-ali.esm.js")]),t._v(" "),a("li",[t._v("upload-to-ali.min.js")]),t._v(" "),a("li",[t._v("upload-to-ali.umd.js")])]),t._v(" "),a("p",[t._v("使用者import组件时，默认import进来的是 upload-to-ali.umd.js。 关于三个文件的相关描述，📦vue组件发布npm最佳实践 已阐述过，就不重复了。")]),t._v(" "),a("p",[t._v("rollup的一个特点是，默认不会把组件的依赖一起打包进去，这个特性有利于减少组件的分发体积。")]),t._v(" "),a("p",[t._v("下面是个示例：")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// src/index.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" crypto "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'crypto'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" axios "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'axios'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("执行 "),a("code",[t._v("yarn build")]),t._v(" , 会得到以下信息\n"),a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/006y8mN6gy1g6nk18iw4xj316y05aq49.jpg",alt:"image.png"}}),t._v("\n请不用担心这个警告，这是有意而为之的，因为不想把依赖把打包进dist进去了。")]),t._v(" "),a("h3",{attrs:{id:"commit规范"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#commit规范","aria-hidden":"true"}},[t._v("#")]),t._v(" commit规范")]),t._v(" "),a("p",[t._v("在继续下面的内容之前，再复习一下"),a("a",{attrs:{href:"https://www.conventionalcommits.org/en/v1.0.0-beta.4/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Conventional Commits"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("摘取重点如下，格式为：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("<type>(<scope>): <subject>\n<BLANK LINE>\n<body>\n<BLANK LINE>\n<footer>\n")])])]),a("p",[t._v("其中"),a("code",[t._v("<type>")]),t._v(": "),a("code",[t._v("<subject>")]),t._v(" 是必须的。")]),t._v(" "),a("p",[t._v("type的类型有：")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("feat")]),t._v(": A new feature")]),t._v(" "),a("li",[a("strong",[t._v("fix")]),t._v(": A bug fix")]),t._v(" "),a("li",[a("strong",[t._v("docs")]),t._v(": Documentation only changes")]),t._v(" "),a("li",[a("strong",[t._v("style")]),t._v(": Changes that do not affect the meaning of the code (white-space, formatting, missing semi-colons, etc)")]),t._v(" "),a("li",[a("strong",[t._v("refactor")]),t._v(": A code change that neither fixes a bug nor adds a feature")]),t._v(" "),a("li",[a("strong",[t._v("perf")]),t._v(": A code change that improves performance")]),t._v(" "),a("li",[a("strong",[t._v("test")]),t._v(": Adding missing or correcting existing tests")]),t._v(" "),a("li",[a("strong",[t._v("chore")]),t._v(": Changes to the build process or auxiliary tools and libraries such as documentation generation")])]),t._v(" "),a("p",[t._v("另外约定，更新依赖使用 chore(deps)，这也是github官方的做法")]),t._v(" "),a("h3",{attrs:{id:"pr自动打标签"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pr自动打标签","aria-hidden":"true"}},[t._v("#")]),t._v(" PR自动打标签")]),t._v(" "),a("p",[t._v("由于"),a("a",{attrs:{href:"https://github.com/github-tools/github-release-notes",target:"_blank",rel:"noopener noreferrer"}},[t._v("github-release-notes"),a("OutboundLink")],1),t._v("生成的release notes只对打上了label的Pull Request才有效，因此给github仓库添加一个"),a("a",{attrs:{href:"https://github.com/levy9527/auto-add-label",target:"_blank",rel:"noopener noreferrer"}},[t._v("自动添加label的机器人"),a("OutboundLink")],1),t._v("，避免重复劳动。")]),t._v(" "),a("h4",{attrs:{id:"流程详解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#流程详解","aria-hidden":"true"}},[t._v("#")]),t._v(" 流程详解")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/006y8mN6gy1g6nk4bfl87j30ua0e2dhy.jpg",alt:""}})]),t._v(" "),a("h4",{attrs:{id:"grenrc-js"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#grenrc-js","aria-hidden":"true"}},[t._v("#")]),t._v(" .grenrc.js")]),t._v(" "),a("p",[t._v(".grenrc.js是github release notes 的配置, 这是参考了nuxt、github以及其他流行仓库后得到的配置，可以拿来即用")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  dataSource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'prs'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  prefix"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ignoreLabels"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'duplicate'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'help wanted'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'invalid'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'question'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'wontfix'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ignoreIssuesWith"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'duplicate'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'help wanted'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'invalid'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'question'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'wontfix'")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  onlyMilestones"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  changelogFilename"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'CHANGELOG.md'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  template"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    issue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'- {{name}} [{{text}}]({{url}})'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    group"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n### {{heading}}\\n'")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// https://github.com/nuxt/nuxt.js/releases")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// https://gitmoji.carloscuesta.me")]),t._v("\n  groupBy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'✨ New Features:'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'enhancement'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'🐛 Bug Fixes:'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bug'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'📖 Documentation:'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'documentation'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'💅 Refactors:'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'refactor'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'♻️ Tests:'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'🚀 Performance:'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'performance'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'⚓ Dependency upgrades:'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dependencies'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'🏡 Chore:'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'chore'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'💄 Style:'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'style'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'🎩 Hack'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hack'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"自动发布"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自动发布","aria-hidden":"true"}},[t._v("#")]),t._v(" 自动发布")]),t._v(" "),a("h4",{attrs:{id:"travis-ci"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#travis-ci","aria-hidden":"true"}},[t._v("#")]),t._v(" Travis CI")]),t._v(" "),a("p",[t._v("主要利用Travis CI做到自动化，先看下面的 "),a("code",[t._v(".travis.yml")]),t._v(" 配置：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/006y8mN6gy1g6nju941mej31240u0go8.jpg",alt:"image.png"}})]),t._v(" "),a("p",[t._v("上面参数的具体说明，可以参考教程："),a("a",{attrs:{href:"https://github.com/levy9527/blog/issues/1",target:"_blank",rel:"noopener noreferrer"}},[t._v("🚀Github集成TravisCI：自动发布"),a("OutboundLink")],1)]),t._v(" "),a("h4",{attrs:{id:"流程详解-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#流程详解-2","aria-hidden":"true"}},[t._v("#")]),t._v(" 流程详解")]),t._v(" "),a("p",[t._v("其主要流程如下图所示：\n"),a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/006y8mN6gy1g6nk5dsnyzj31do0t6gqs.jpg",alt:""}})]),t._v(" "),a("h4",{attrs:{id:"build-sh"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-sh","aria-hidden":"true"}},[t._v("#")]),t._v(" build.sh")]),t._v(" "),a("p",[t._v("build.sh内容如下：")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/sh")]),t._v("\nyarn stdver\n\nyarn build\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" remote add github https://"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$GITHUB_TOKEN@github")]),t._v(".com/FEMessage/upload-to-ali.git "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /dev/null 2"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("1\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" push github HEAD:master --follow-tags\n")])])]),a("p",[t._v("与之相对应的，package.json里scipts需要有以下字段：")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"stdver"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"standard-version -m '[skip ci] chore(release): v%s'\"")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"release"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gren release --override"')]),t._v("\n")])])]),a("p",[t._v("notify.sh内容如下：")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/sh")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$TRAVIS_TEST_RESULT")]),t._v('"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"build not success, bye"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exit")]),t._v(" 1\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fi")]),t._v("\n\nurl"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("https://api.github.com/repos/FEMessage/upload-to-ali/releases/latest\nresp_tmp_file"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("resp.tmp\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -H "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Authorization: token '),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$GITHUB_TOKEN")]),t._v('"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$url")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$resp_tmp_file")]),t._v("\n\nhtml_url"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" $resp_tmp_file "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sed")]),t._v(" -n 5p "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sed")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'s/\\\"html_url\\\"://g'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("awk")]),t._v(" -F "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\"'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{print "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$2")]),t._v("}'")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("\nbody"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" $resp_tmp_file "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" body "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sed")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'s/\\"body\\"://g;s/\\"//g\'')]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("\n\nmsg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"msgtype": "markdown", "markdown": {"title": "upload-to-ali更新", "text": "@所有人\\n# [upload-to-ali](\'')]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$html_url")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("')\\n'")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$body")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\"}}'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -X POST https://oapi.dingtalk.com/robot/send\\?access_token\\"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$DINGTALK_ROBOT_TOKEN")]),t._v(" -H "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/json'")]),t._v(" -d "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$msg")]),t._v('"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$resp_tmp_file")]),t._v("\n")])])]),a("p",[t._v("这里有两个关键点：")]),t._v(" "),a("ul",[a("li",[t._v("构建失败，不发送消息")]),t._v(" "),a("li",[t._v("调用github api获取最新release时，带上github token")])]),t._v(" "),a("h3",{attrs:{id:"readme-md"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#readme-md","aria-hidden":"true"}},[t._v("#")]),t._v(" README.md")]),t._v(" "),a("p",[t._v("参考了优秀开源项目后，我们搜索出了一套README.md模板，内置在初始化工程里了\n"),a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/006y8mN6gy1g6njszpy1dj319o0u0416.jpg",alt:"image.png"}})]),t._v(" "),a("p",[t._v("还有常见的badge\n"),a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/006y8mN6gy1g6njssu1jmj310e02swez.jpg",alt:"image.png"}})]),t._v(" "),a("p",[t._v("以及contributors\n"),a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/006y8mN6gy1g6njsleix6j31as0u00zp.jpg",alt:"image.png"}}),t._v("\n相关emoji代表的意思，可以看"),a("a",{attrs:{href:"https://allcontributors.org/docs/en/emoji-key",target:"_blank",rel:"noopener noreferrer"}},[t._v("官方文档"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"结语"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#结语","aria-hidden":"true"}},[t._v("#")]),t._v(" 结语")]),t._v(" "),a("p",[t._v("最后，欢迎大家使用"),a("a",{attrs:{href:"https://github.com/FEMessage/vue-sfc-cli",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/FEMessage/vue-sfc-cli"),a("OutboundLink")],1),t._v("开发vue组件～")])])},[],!1,null,null,null);s.default=n.exports}}]);