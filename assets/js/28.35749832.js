(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{224:function(a,s,e){"use strict";e.r(s);var t=e(2),r=Object(t.a)({},function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"ğŸ³ä»é›¶å¼€å§‹dockeråŒ–node-jsåº”ç”¨"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ³ä»é›¶å¼€å§‹dockeråŒ–node-jsåº”ç”¨","aria-hidden":"true"}},[a._v("#")]),a._v(" ğŸ³ä»é›¶å¼€å§‹DockeråŒ–Node.jsåº”ç”¨")]),a._v(" "),e("h2",{attrs:{id:"èƒŒæ™¯"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#èƒŒæ™¯","aria-hidden":"true"}},[a._v("#")]),a._v(" èƒŒæ™¯")]),a._v(" "),e("p",[a._v("ç»™ä½ ä¸€å°æ–°ä¹°çš„æœåŠ¡å™¨(CentOS)ï¼Œç›¸å…³è´¦æˆ·åŠå¯†ç ï¼Œä¸€ä¸ªåŸºäºNode.jså¼€å‘çš„webåº”ç”¨æºç åŒ…(zip)ï¼Œè¦æ±‚ä½ åœ¨æ–°æœºå™¨ä¸Šä½¿ç”¨Dockerçš„æ–¹å¼æŠŠåº”ç”¨éƒ¨ç½²èµ·æ¥ã€‚æ­¤æ—¶çš„ä½ ï¼Œå¹¶æ²¡æœ‰ææ¸…æ¥šä»€ä¹ˆæ˜¯å®¹å™¨/é•œåƒï¼Œä¹Ÿæ²¡è®°ä½å‡ ä¸ªç›¸å…³çš„Linuxå‘½ä»¤ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿæœ¬æ–‡å°†å¸®åŠ©ä½ æ‘†è„±å›°å¢ƒ")]),a._v(" "),e("h2",{attrs:{id:"æ–¹æ¡ˆ"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#æ–¹æ¡ˆ","aria-hidden":"true"}},[a._v("#")]),a._v(" æ–¹æ¡ˆ")]),a._v(" "),e("h3",{attrs:{id:"æµç¨‹"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#æµç¨‹","aria-hidden":"true"}},[a._v("#")]),a._v(" æµç¨‹")]),a._v(" "),e("p",[a._v("ä¸ºè¾¾åˆ°æœ€ç»ˆç›®çš„ï¼Œå…ˆæ¥æ¢³ç†ä¸€æ³¢æµç¨‹ï¼š")]),a._v(" "),e("ol",[e("li",[a._v("æŠŠæºç zipåŒ…ä¸Šä¼ è‡³æœåŠ¡å™¨")]),a._v(" "),e("li",[a._v("ç™»å½•æœåŠ¡å™¨")]),a._v(" "),e("li",[a._v("è§£å‹zipåŒ…")]),a._v(" "),e("li",[a._v("å®‰è£…æœ€æ–°Docker")]),a._v(" "),e("li",[a._v("è®¾ç½®å›½å†…é•œåƒåŠ é€Ÿå™¨")]),a._v(" "),e("li",[a._v("ç¼–å†™Dockerfile")]),a._v(" "),e("li",[a._v("æ„å»ºé•œåƒ")]),a._v(" "),e("li",[a._v("ç¼–å†™å¯åŠ¨å®¹å™¨è„šæœ¬")]),a._v(" "),e("li",[a._v("æ‰§è¡Œè„šæœ¬ï¼Œæ£€æŸ¥éƒ¨ç½²æƒ…å†µ")])]),a._v(" "),e("p",[a._v("ä¸‹é¢å°†è¯¦ç»†æè¿°å¦‚ä½•æ“ä½œ")]),a._v(" "),e("blockquote",[e("p",[a._v("æ–‡ä¸­æœåŠ¡å™¨æ“ä½œç³»ç»Ÿä¸ºCentOS 7ï¼Œå¦‚æœä½ çš„æœåŠ¡å™¨ä¸ç›¸ç¬¦ï¼Œæ“ä½œç»†èŠ‚å¯èƒ½ä¼šç•¥æœ‰ä¸åŒï¼Œéœ€è¦å¦è¡ŒæŸ¥é˜…ç›¸å…³èµ„æ–™")])]),a._v(" "),e("h3",{attrs:{id:"rsyncä¼ è¾“"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rsyncä¼ è¾“","aria-hidden":"true"}},[a._v("#")]),a._v(" rsyncä¼ è¾“")]),a._v(" "),e("p",[a._v("å‡è®¾:")]),a._v(" "),e("ul",[e("li",[a._v("æœåŠ¡å™¨åœ°å€ä¸º"),e("code",[a._v("${ip}")])]),a._v(" "),e("li",[a._v("å¸æˆ·ä¸º"),e("code",[a._v("${user}")])]),a._v(" "),e("li",[a._v("å¯†ç ä¸º"),e("code",[a._v("${pass}")])]),a._v(" "),e("li",[a._v("æºç åŒ…ä¸º"),e("code",[a._v("${zip}")])]),a._v(" "),e("li",[a._v("zipåŒ…æ”¾åˆ°æœåŠ¡å™¨çš„ç›®å½•ä¸º"),e("code",[a._v("${path}")])])]),a._v(" "),e("p",[a._v("åˆ™åœ¨æœ¬æœºæºç åŒ…åŒçº§ç›®å½•ä¸‹ï¼Œä½¿ç”¨"),e("code",[a._v("scp")]),a._v("å‘½ä»¤ï¼ŒæŠŠzipåŒ…ä¼ è¾“è‡³æœåŠ¡å™¨çš„ç¤ºä¾‹å¦‚ä¸‹")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("rsync")]),a._v(" -avzP ./"),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${zip}")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${user}")]),a._v("@"),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${ip}")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${path}")]),a._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# åé¢ä¼šæç¤ºè¾“å…¥å¯†ç ")]),a._v("\n")])])]),e("h3",{attrs:{id:"sshç™»å½•"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#sshç™»å½•","aria-hidden":"true"}},[a._v("#")]),a._v(" sshç™»å½•")]),a._v(" "),e("p",[a._v("æ‰¿æ¥ä¸Šæ–‡ï¼Œsshç™»å½•æœåŠ¡å™¨ç¤ºä¾‹å¦‚ä¸‹")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("ssh")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${user}")]),a._v("@"),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${ip}")]),a._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# åé¢ä¼šæç¤ºè¾“å…¥å¯†ç ")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ç¬¬ä¸€æ¬¡ç™»å½•ä¼šæç¤ºä¿å­˜sshä¿¡æ¯ï¼Œè¾“å…¥yeså³å¯")]),a._v("\n")])])]),e("p",[a._v("å¦‚æœä¸æƒ³æ¯æ¬¡éƒ½è¾“å…¥åœ°å€/å¸æˆ·/å¯†ç ï¼Œå¯ä»¥å†™ä¸€ä¸ªç®€å•çš„è‡ªåŠ¨ç™»å½•è„šæœ¬"),e("code",[a._v("ssh.sh")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# åˆ›å»ºæ–‡ä»¶")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("touch")]),a._v(" ssh.sh\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# èµ‹äºˆè„šæœ¬å¯æ‰§è¡ŒæƒåŠ›")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" +x ssh.sh\n")])])]),e("p",[e("code",[a._v("ssh.sh")]),a._v("å†…å®¹å¦‚ä¸‹ï¼Œè®°å¾—æŠŠ"),e("code",[a._v("${pass}")]),a._v(", "),e("code",[a._v("${user}")]),a._v(","),e("code",[a._v("${ip}")]),a._v("æ›¿æ¢ä¸ºçœŸå®æ•°æ®")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#!/usr/bin/expect")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("timeout")]),a._v(" 30\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" password "),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${pass}")]),a._v("\nspawn "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("ssh")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${user}")]),a._v("@"),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${ip}")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("expect")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"*assword:"')]),a._v("\nsend "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$password")]),a._v('\\r"')]),a._v("\ninteract\n")])])]),e("p",[a._v("æ‰§è¡Œè„šæœ¬å³å¯ç™»å½•æœåŠ¡å™¨ğŸ˜„")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("./ssh.sh\n")])])]),e("h3",{attrs:{id:"unzipè§£å‹"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#unzipè§£å‹","aria-hidden":"true"}},[a._v("#")]),a._v(" unzipè§£å‹")]),a._v(" "),e("p",[a._v("å¦‚ä¸Šæ‰€è¯´ï¼Œæºç åŒ…åä¸º"),e("code",[a._v("${zip}")]),a._v("ï¼Œè§£å‹å‘½ä»¤å¦‚ä¸‹")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("unzip "),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${zip}")]),a._v("\n")])])]),e("p",[a._v("é™„å¸¦ä¸€å¥, å¦‚æœè¦ç”¨å‘½ä»¤ç”ŸæˆzipåŒ…ï¼Œå‡è®¾æºæ–‡ä»¶ç›®å½•ä¸º"),e("code",[a._v("dist")]),a._v("ï¼Œè¦ç”Ÿæˆçš„zipåŒ…ä¸º"),e("code",[a._v("dist.zip")]),a._v(", å…¶å‘½ä»¤å¦‚ä¸‹")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("zip")]),a._v(" -r dist.zip dist\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# æˆ–ç®€å†™ä¸º")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("zip")]),a._v(" -r dist dist\n")])])]),e("h3",{attrs:{id:"å®‰è£…docker-ce"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#å®‰è£…docker-ce","aria-hidden":"true"}},[a._v("#")]),a._v(" å®‰è£…Docker-CE")]),a._v(" "),e("p",[a._v("CEæ„ä¸º"),e("code",[a._v("Community Edition")]),a._v(", å³ç¤¾åŒºç‰ˆï¼Œå…è´¹; ä¸ä¹‹å¯¹åº”çš„æ˜¯EEï¼Œ"),e("code",[a._v("Enterprise Edition")]),a._v(",  ä¼ä¸šç‰ˆï¼Œå¼ºè°ƒå®‰å…¨ï¼Œä»˜è´¹ä½¿ç”¨ã€‚")]),a._v(" "),e("ul",[e("li",[a._v("å¸è½½æ—§ç‰ˆæœ¬çš„Docker")])]),a._v(" "),e("p",[a._v("å¦‚æœæ–°æœºå™¨ä¸Šæ²¡æœ‰dockerï¼Œè·³è‡³ä¸‹ä¸€æ­¥ï¼Œç›´æ¥å®‰è£…Dockerçš„ä¾èµ–")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" yum remove docker \\\n                  docker-common \\\n                  container-selinux \\\n                  docker-selinux \\\n                  docker-engine \\\n                  docker-engine-selinux\n")])])]),e("ul",[e("li",[a._v("å®‰è£…Dockerçš„ä¾èµ–")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" yum "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" -y yum-utils device-mapper-persistent-data lvm2\n")])])]),e("ul",[e("li",[a._v("å®‰è£…Dockerå®˜æ–¹ä»“åº“")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" yum-config-manager \\\n    --add-repo \\\n    https://download.docker.com/linux/centos/docker-ce.repo\n")])])]),e("ul",[e("li",[a._v("æ›´æ–°ä»“åº“æº")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" yum makecache fast\n")])])]),e("ul",[e("li",[a._v("ä»ä»“åº“å®‰è£…Docker-CE")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" yum "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" docker-ce\n")])])]),e("h3",{attrs:{id:"é…ç½®åŠ é€Ÿå™¨"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#é…ç½®åŠ é€Ÿå™¨","aria-hidden":"true"}},[a._v("#")]),a._v(" é…ç½®åŠ é€Ÿå™¨")]),a._v(" "),e("p",[a._v("ä½¿ç”¨ Docker çš„æ—¶å€™ï¼Œéœ€è¦ç»å¸¸ä»å®˜æ–¹è·å–é•œåƒï¼Œä½†æ˜¯ç”±äºæ˜¾è€Œæ˜“è§çš„ç½‘ç»œåŸå› ï¼Œæ‹‰å–é•œåƒçš„è¿‡ç¨‹éå¸¸è€—æ—¶ï¼Œä¸¥é‡å½±å“ä½¿ç”¨ Docker çš„ä½“éªŒã€‚")]),a._v(" "),e("p",[a._v("æ¨èä½¿ç”¨"),e("a",{attrs:{href:"https://www.daocloud.io/mirror#accelerator-doc",target:"_blank",rel:"noopener noreferrer"}},[a._v("DaoCloudçš„åŠ é€Ÿå™¨"),e("OutboundLink")],1)]),a._v(" "),e("h3",{attrs:{id:"dockerfile"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile","aria-hidden":"true"}},[a._v("#")]),a._v(" Dockerfile")]),a._v(" "),e("p",[a._v("æ‰€æœ‰ç¯å¢ƒé…ç½®å·²å‡†å¤‡å®Œæ¯•ï¼Œå¯ä»¥æ ¹æ®Node.jsåº”ç”¨ç¼–å†™Dockerfileäº†")]),a._v(" "),e("p",[a._v("å‡è®¾Node.jsåº”ç”¨çš„å¯åŠ¨å‘½ä»¤ä¸º"),e("code",[a._v("npm start")]),a._v(", ç›‘å¬ç«¯å£ä¸º"),e("code",[a._v("${app_port}")])]),a._v(" "),e("ul",[e("li",[a._v("åˆ›å»ºDockerfile")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("touch")]),a._v(" Dockerfile\n")])])]),e("p",[e("code",[a._v("Dockerfile")]),a._v("å†…å®¹å¦‚ä¸‹")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# å¯ä»¥æŒ‡å®šä¾èµ–çš„nodeé•œåƒçš„ç‰ˆæœ¬ node:<version>ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œå°±ä¼šæ˜¯æœ€æ–°çš„")]),a._v("\nFROM node:8\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# åˆ›å»ºå·¥ä½œç›®å½•ï¼Œå¯¹åº”çš„æ˜¯åº”ç”¨ä»£ç å­˜æ”¾åœ¨å®¹å™¨å†…çš„è·¯å¾„")]),a._v("\nWORKDIR /usr/src/app\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# æŠŠ package.jsonï¼Œpackage-lock.json(npm@5+) æˆ– yarn.lock å¤åˆ¶åˆ°å·¥ä½œç›®å½•(ç›¸å¯¹è·¯å¾„)")]),a._v("\nCOPY package.json *.lock "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v(".")]),a._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# åªå®‰è£…dependenciesä¾èµ–")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# nodeé•œåƒè‡ªå¸¦yarn")]),a._v("\nRUN yarn --only"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("prod --registry"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("https://registry.npm.taobao.org\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# æŠŠå…¶ä»–æºæ–‡ä»¶å¤åˆ¶åˆ°å·¥ä½œç›®å½•")]),a._v("\nCOPY "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v(".")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v(".")]),a._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# æ›¿æ¢æˆåº”ç”¨å®é™…çš„ç«¯å£å·")]),a._v("\nEXPOSE "),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${app_port}")]),a._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# è¿™é‡Œæ ¹æ®å®é™…èµ·åŠ¨å‘½ä»¤åšä¿®æ”¹")]),a._v("\nCMD "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"npm"')]),a._v(", "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"start"')]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n")])])]),e("ul",[e("li",[a._v("è¡¥å…….dockerignore")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("touch")]),a._v(" .dockerignore\n")])])]),e("p",[e("code",[a._v(".dockerignore")]),a._v("å†…å®¹å¦‚ä¸‹")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("node_modules\nnpm-debug.log\n")])])]),e("h3",{attrs:{id:"æ„å»ºé•œåƒ"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#æ„å»ºé•œåƒ","aria-hidden":"true"}},[a._v("#")]),a._v(" æ„å»ºé•œåƒ")]),a._v(" "),e("p",[a._v("å†™å¥½"),e("code",[a._v("Dockerfile")]),a._v("ï¼Œå°±å¯ä»¥åœ¨Dockerfileæ‰€åœ¨ç›®å½•æ„å»ºé•œåƒäº†ã€‚")]),a._v(" "),e("p",[a._v("å‘½ä»¤å¦‚ä¸‹ã€‚"),e("code",[a._v("-t")]),a._v("æ˜¯ä¸ºäº†ç»™é•œåƒåŠ ä¸ªæ ‡ç­¾ï¼Œè¿™æ ·æ–¹ä¾¿ä½¿ç”¨"),e("code",[a._v("docker images")]),a._v("å‘½ä»¤æ—¶æ£€ç´¢åˆ°")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ${your_name} å¯ä»¥çœç•¥")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ${tag} çœç•¥æ—¶ä¸º latest")]),a._v("\ndocker build -t "),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${your_name}")]),a._v("/"),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${image_name}")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${tag}")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v(".")]),a._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# çœç•¥ç‰ˆæœ¬")]),a._v("\ndocker build -t "),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${image_name}")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v(".")]),a._v("\n")])])]),e("p",[a._v("æŸ¥çœ‹é•œåƒ")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("docker images\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ç¤ºä¾‹è¾“å‡º")]),a._v("\nREPOSITORY                      TAG        ID              CREATED\nnode                            8          1934b0b038d1    5 days ago\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${your_name}")]),a._v("/"),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${image_name}")]),a._v("    latest     d64d3505b0d2    1 minute ago\n")])])]),e("h3",{attrs:{id:"å¯åŠ¨å®¹å™¨è„šæœ¬"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#å¯åŠ¨å®¹å™¨è„šæœ¬","aria-hidden":"true"}},[a._v("#")]),a._v(" å¯åŠ¨å®¹å™¨è„šæœ¬")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("touch")]),a._v(" start.sh\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" +x start.sh\n")])])]),e("p",[e("code",[a._v("start.sh")]),a._v("ä¼šæ ¹æ®é•œåƒæ–°å»ºä¸€ä¸ªå®¹å™¨å¹¶å¯åŠ¨ï¼Œå†…å®¹å¦‚ä¸‹")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#!/usr/bin/env bash")]),a._v("\n\ncontainer"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${container_name}")]),a._v("\nimage"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${image_name || image_id}")]),a._v("\n\ndocker run \\\n--rm \\\n-d \\\n-p "),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${host_port}")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${app_port}")]),a._v(" \\\n--name "),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$container")]),a._v(" \\\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$image")]),a._v("\n")])])]),e("p",[e("code",[a._v("${host_port}")]),a._v("æ˜¯å¤–ç½‘è®¿é—®éƒ¨ç½²å¥½çš„åº”ç”¨æ—¶å¯¹åº”çš„ç«¯å£")]),a._v(" "),e("p",[e("code",[a._v("${app_port}")]),a._v("æ˜¯å®¹å™¨å†…Node.jsåº”ç”¨ç›‘å¬çš„ç«¯å£")]),a._v(" "),e("p",[e("code",[a._v("${image_name}")]),a._v("æ˜¯å‰é¢æ„å»ºå‡ºçš„é•œåƒçš„åå­—ï¼Œå¯ç”¨"),e("code",[a._v("docker images")]),a._v("æŸ¥çœ‹")]),a._v(" "),e("p",[e("code",[a._v("${container_name}")]),a._v("æ˜¯ç»™å®¹å™¨èµ‹äºˆçš„åå­—ï¼Œæ–¹ä¾¿"),e("code",[a._v("docker ps")]),a._v("å‘½ä»¤æ—¶æ£€ç´¢")]),a._v(" "),e("p",[a._v("--rm å®¹å™¨é€€å‡ºåéšä¹‹å°†å…¶åˆ é™¤")]),a._v(" "),e("p",[a._v("-d åå°è¿è¡Œ")]),a._v(" "),e("p",[a._v("-p æŒ‡å®šç«¯å£æ˜ å°„ï¼Œå‰è€…æ˜¯æœåŠ¡å™¨å™¨ç«¯å£ï¼Œä¹Ÿå³å¤–ç•Œè®¿é—®ä½ éƒ¨ç½²å¥½çš„webåº”ç”¨çš„ç«¯å£; åè€…æ˜¯"),e("code",[a._v("Dockerfile")]),a._v("é‡Œ"),e("code",[a._v("EXPOSE")]),a._v("çš„ç«¯å£")]),a._v(" "),e("p",[a._v("--name æŒ‡å®šå®¹å™¨åå­—")]),a._v(" "),e("h3",{attrs:{id:"æµ‹è¯•"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#æµ‹è¯•","aria-hidden":"true"}},[a._v("#")]),a._v(" æµ‹è¯•")]),a._v(" "),e("p",[a._v("è®¿é—®åˆšåˆšå¯åŠ¨çš„å®¹å™¨é‡Œçš„åº”ç”¨")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" -i localhost:"),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${host_port}")]),a._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ç¤ºä¾‹è¾“å‡º")]),a._v("\nHTTP/1.1 200 OK\nX-Powered-By: Express\nContent-Type: text/html"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" charset"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("utf-8\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\n")])])]),e("p",[a._v("æ­å–œï¼Œéƒ¨ç½²æˆåŠŸğŸ‘")]),a._v(" "),e("h3",{attrs:{id:"å¸¸ç”¨å‘½ä»¤"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#å¸¸ç”¨å‘½ä»¤","aria-hidden":"true"}},[a._v("#")]),a._v(" å¸¸ç”¨å‘½ä»¤")]),a._v(" "),e("ul",[e("li",[a._v("æŸ¥çœ‹è¿è¡Œä¸­çš„å®¹å™¨")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("docker "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("ps")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# æˆ–ä½¿ç”¨æ–°å‘½ä»¤")]),a._v("\ndocker container "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("ls")]),a._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ç¤ºä¾‹è¾“å‡º")]),a._v("\nID            IMAGE                                COMMAND    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".   PORTS\necce33b30ebf  "),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${your_name}")]),a._v("/"),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${image_name}")]),a._v(":latest  "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" start  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".   49160-"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("8080\n")])])]),e("ul",[e("li",[a._v("æŸ¥çœ‹æ‰€æœ‰å®¹å™¨(åŒ…æ‹¬å·²ç»ˆæ­¢çš„)")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("docker "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("ps")]),a._v(" -a\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# æˆ–ä½¿ç”¨æ–°å‘½ä»¤")]),a._v("\ndocker container "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("ls")]),a._v(" -a\n")])])]),e("ul",[e("li",[a._v("æŸ¥çœ‹æŸå®¹å™¨å†…æ—¥å¿—")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("docker logs -f "),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${container_id}")]),a._v("\n")])])]),e("ul",[e("li",[a._v("è¿›å…¥æŸå®¹å™¨ï¼Œå¹¶æœ‰shellæ‰§è¡Œç¯å¢ƒ")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# è¿›å…¥å®¹å™¨")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# -iè¡¨ç¤ºï¼šäº¤äº’å¼æ“ä½œï¼Œ-tè¡¨ç¤ºï¼šç»ˆç«¯")]),a._v("\ndocker "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("exec")]),a._v(" -it "),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${container_id}")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("bash")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# å¯é€šè¿‡è¾“å…¥ exit é€€å‡º")]),a._v("\n")])])]),e("ul",[e("li",[a._v("åœæ­¢å®¹å™¨")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("docker container stop "),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${container_id}")]),a._v("\n")])])]),e("ul",[e("li",[a._v("å¯åŠ¨å·²ç»ˆæ­¢çš„å®¹å™¨")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("docker container start "),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${container_id}")]),a._v("\n")])])]),e("ul",[e("li",[a._v("åˆ é™¤å®¹å™¨")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("docker container "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${container_name || container_id}")]),a._v("\n")])])]),e("ul",[e("li",[a._v("æŸ¥çœ‹é•œåƒ")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("docker images\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# æˆ–ä½¿ç”¨æ–°å‘½ä»¤")]),a._v("\ndocker image "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("ls")]),a._v("\n")])])]),e("ul",[e("li",[a._v("åˆ é™¤é•œåƒ")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("docker image "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${image_id}")]),a._v("\n")])])]),e("h2",{attrs:{id:"faq"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#faq","aria-hidden":"true"}},[a._v("#")]),a._v(" FAQ")]),a._v(" "),e("ul",[e("li",[a._v("ä¸ä¼šviï¼Œä¸æ‡‚æ€ä¹ˆåœ¨æœåŠ¡å™¨ç¼–è¾‘"),e("code",[a._v("Dockerfile")]),a._v("ç­‰æ–‡ä»¶ï¼Œæ€ä¹ˆåŠï¼Ÿ")])]),a._v(" "),e("blockquote",[e("p",[a._v("å¯ä»¥å‚è€ƒæœ¬æ–‡ï¼ŒæŠŠæ–‡ä»¶åœ¨æœ¬åœ°åˆ›å»ºå¥½ï¼Œå†é€šè¿‡"),e("code",[a._v("scp")]),a._v("æŠŠåˆ›å»ºçš„æ–‡ä»¶è·Ÿæºç åŒ…ä¸€èµ·ä¸Šä¼ åˆ°æœåŠ¡å™¨")])]),a._v(" "),e("ul",[e("li",[a._v("ä¸ºä»€ä¹ˆä½¿ç”¨yarn?")])]),a._v(" "),e("blockquote",[e("p",[a._v("å› ä¸ºyarnçš„é€Ÿåº¦æ¯”npmæ›´å¿«ï¼Œè€Œdockeré‡Œçš„nodeé•œåƒè‡ªå¸¦äº†yarn, æ­£å¥½é¼“åŠ±å¤§å®¶ä½¿ç”¨yarn")])]),a._v(" "),e("ul",[e("li",[a._v("å¦‚æœé¡¹ç›®æœ‰å…¨å±€ä¾èµ–ï¼Œå¦‚bowerï¼ŒDockerfileæ€ä¹ˆå†™ï¼Ÿ")])]),a._v(" "),e("blockquote",[e("p",[a._v("å¯ä»¥å…ˆå®‰è£…å…¶ä»–å…¨å±€ä¾èµ–ï¼Œå†ä½¿ç”¨yarnå®‰è£…ï¼Œè®°å¾—å‘½ä»¤å†™åœ¨ä¸€ä¸ªRUNæŒ‡ä»¤é‡Œ, ä¸‹é¢æ˜¯éƒ¨åˆ†ç¤ºä¾‹")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("RUN yarn config "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" registry https://registry.npm.taobao.org \\\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" yarn global "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" bower \\\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" bower i --allow-root \\\n    yarn\n")])])]),e("h2",{attrs:{id:"å‚è€ƒ"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#å‚è€ƒ","aria-hidden":"true"}},[a._v("#")]),a._v(" å‚è€ƒ")]),a._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://nodejs.org/en/docs/guides/nodejs-docker-webapp",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://nodejs.org/en/docs/guides/nodejs-docker-webapp"),e("OutboundLink")],1)]),a._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/nodejs/docker-node/blob/master/README.md#image-variants",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://github.com/nodejs/docker-node/blob/master/README.md#image-variants"),e("OutboundLink")],1)]),a._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/waylybaye/HyperApp-Guide/blob/master/zh/centos-upgrade-docker.md",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://github.com/waylybaye/HyperApp-Guide/blob/master/zh/centos-upgrade-docker.md"),e("OutboundLink")],1)]),a._v(" "),e("li",[e("a",{attrs:{href:"https://docs.docker.com/v1.11/engine/reference/commandline/cli/",target:"_blank",rel:"noopener noreferrer"}},[a._v("Dockerå‘½ä»¤æŸ¥è¯¢"),e("OutboundLink")],1)])]),a._v(" "),e("h2",{attrs:{id:"æ³¨"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#æ³¨","aria-hidden":"true"}},[a._v("#")]),a._v(" æ³¨")]),a._v(" "),e("p",[a._v("æœ¬æ–‡æœ€æ—©å‘å¸ƒåœ¨æ˜é‡‘ï¼Œåè¿ç§»è‡³"),e("a",{attrs:{href:"https://github.com/levy9527/blog/issues/3",target:"_blank",rel:"noopener noreferrer"}},[a._v("github"),e("OutboundLink")],1),a._v("ã€‚")])])},[],!1,null,null,null);s.default=r.exports}}]);